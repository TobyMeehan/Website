@using System.IO

@inject IFileReaderService fileReaderService

<input type="file" @attributes="AdditionalAttributes" @ref="_inputElement" @onchange="FileChanged" />

@code {
    [Parameter(CaptureUnmatchedValues = true)] public Dictionary<string, object> AdditionalAttributes { get; set; }

    [Parameter] public EventCallback<IFileReference[]> OnChange { get; set; }

    private ElementReference _inputElement;

    private async Task FileChanged()
    {
        var files = await fileReaderService.CreateReference(_inputElement).EnumerateFilesAsync();
        await OnChange.InvokeAsync(files.ToArray());
    }
}
